<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8"/>
  <meta content="width=device-width, initial-scale=1.0" name="viewport"/>
  <title>Product Page</title>
  <link rel="stylesheet" href="src/css/pages/produto.css"> 
  <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/all.min.css" rel="stylesheet"/>
</head>

<body>

    <script src="src/templates/header.js"></script>
    
    <div class="container">
        <div class="product-image">
          <div class="main-image">
            <img alt="Main product image" src="src/images/barraca.png" class="imagens" id="main-product-image" />
          </div>
      
          <div class="thumbnails">
            <div class="thumbnail">
              <img alt="Thumbnail image 1" src="src/images/barraca.png" class="imagens" id="thumbnail-1"/>
            </div>
            <div class="thumbnail">
              <img alt="Thumbnail image 2" src="src/images/b2.png" class="imagens" id="thumbnail-2"/>
            </div>
            <div class="thumbnail">
              <img alt="Thumbnail image 3" src="src/images/b3.png" class="imagens" id="thumbnail-3"/>
            </div>
          </div>
        </div>
      
        <div class="product-details">
          <h1 id="product-title">Barraca 1 Porta</h1>
          <a href="#" id="product-category">casa de barraca</a>
          <p id="product-description" class="product-description">Barraca azul para casal</p>
          <p id="product-price" class="price">R$ 120,00</p>
      
          <div class="buttons">
            <button class="add-to-cart">ADICIONAR AO CARRINHO</button>
            <button class="add-to-wishlist">
              <i class="far fa-heart"></i>
            </button>
          </div>
        </div>
      </div>
      
      <script>
      
        const imagens = document.querySelectorAll('.imagens');
      
        // Adicionando evento de clique para cada imagem
        imagens.forEach(function(img) {
          img.addEventListener('click', function() {
           
            const sourceDaNova = img.src;
      
          
            const srcClean = transformarParaRelativo(sourceDaNova);
            console.log(srcClean);
            
            
            const imgPrincipal = document.getElementById('main-product-image');
            imgPrincipal.src = srcClean;
        });
    });
    console.log();
      
        // Função para transformar URLs absolutas em re
        const transformarParaRelativo = (url) => {
            console.log(url + " urlllllll");
            let partes = url.split('/'); 
            partes.splice(0, 3);
            console.log(partes.join('/') + " corteee");
            return partes.join('/'); 
        };
        
        document.addEventListener('DOMContentLoaded', function() {
    const addToCartBtn = document.querySelector('.add-to-cart');
    
    const addToWishlistIcon = document.querySelector('.add-to-wishlist i');

   
    function obterDadosProduto() {
      return {
        id: 'barraca1', 
        titulo: document.getElementById('product-title').innerText,
        categoria: document.getElementById('product-category').innerText,
        descricao: document.getElementById('product-description').innerText,
        preco: document.getElementById('product-price').innerText,
        imagem: document.getElementById('main-product-image').src
      };
    }

    
    addToCartBtn.addEventListener('click', function() {
      const produto = obterDadosProduto();
      let carrinho = JSON.parse(localStorage.getItem('carrinho')) || [];
      
      const indexExistente = carrinho.findIndex(item => item.id === produto.id);
      if (indexExistente !== -1) {
       
        carrinho[indexExistente].quantidade = (carrinho[indexExistente].quantidade || 1) + 1;
      } else {
        produto.quantidade = 1;
        carrinho.push(produto);
      }
      
      localStorage.setItem('carrinho', JSON.stringify(carrinho));
      alert('Produto adicionado ao carrinho!');
      
      
      window.location.href = 'carrinho.html';
    });

    
    addToWishlistIcon.addEventListener('click', function() {
      const produto = obterDadosProduto();
      let favoritos = JSON.parse(localStorage.getItem('favoritos')) || [];
      
      const index = favoritos.findIndex(item => item.id === produto.id);
      
      if (index !== -1) {
       
        favoritos.splice(index, 1);
   
        addToWishlistIcon.classList.remove('fas');
        addToWishlistIcon.classList.add('far');
        alert('Produto removido dos favoritos!');
      } else {
       
        favoritos.push(produto);
       
        addToWishlistIcon.classList.remove('far');
        addToWishlistIcon.classList.add('fas');
        alert('Produto adicionado aos favoritos!');
      }
      
      localStorage.setItem('favoritos', JSON.stringify(favoritos));
    });
  });
  
      </script>
  <script src="src/templates/footer.js"></script>
</body>
</html>